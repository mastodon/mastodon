(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,n){},229:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(68),c=n.n(o),r=(n(82),n(69)),l=n(70),s=n(75),u=n(71),d=n(76),h=n(1),g=n(35),m=n.n(g),f=(n(103),n(72)),v=n.n(f),p=n(73),b=n.n(p),w=n(74),y=function(e){var t=Math.max.apply(null,e.map(function(e){return e.favourites_count+e.reblogs_count}));return e.reduce(function(e,n){return e.concat(n.media_attachments.filter(function(e){return"image"===e.type}).map(function(e){return Object.assign({},e,{status:n,highlighted:1===n.media_attachments.length&&n.favourites_count+n.reblogs_count>=t})}))},[])},x=function(e){return e.length>0&&e[e.length-1].id},P={title:"Gallery",baseURL:"/",hashtag:!1,onlyLocal:!0},j=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={config:P,initialized:!1,loading:!0,items:[],nextId:!1},n.axios=null,n.handleScroll=n.handleScroll.bind(Object(h.a)(Object(h.a)(n))),n.loadMore=n.loadMore.bind(Object(h.a)(Object(h.a)(n))),n.loadInitialPage=n.loadInitialPage.bind(Object(h.a)(Object(h.a)(n))),n.setupAxios=n.setupAxios.bind(Object(h.a)(Object(h.a)(n))),n.pagePath=n.pagePath.bind(Object(h.a)(Object(h.a)(n))),n.nextPageParams=n.nextPageParams.bind(Object(h.a)(Object(h.a)(n))),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;m.a.get("config.json").then(function(t){var n=t.data;return e.setState({config:n}),n}).catch(function(){}).then(function(t){e.setupAxios(t),e.loadInitialPage()}),window.addEventListener("scroll",this.handleScroll)}},{key:"setupAxios",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P;this.axios=m.a.create({baseURL:e.baseURL})}},{key:"handleScroll",value:function(){var e=document.documentElement;e.scrollHeight-e.scrollTop-e.clientHeight<400&&this.state.nextId&&!this.state.loading&&this.loadMore()}},{key:"loadInitialPage",value:function(){var e=this;this.axios.get(this.pagePath(),{params:this.nextPageParams()}).then(function(t){var n=t.data;e.setState({items:y(n),loading:!1,nextId:x(n),initialized:!0})})}},{key:"pagePath",value:function(){var e=this.state.config.hashtag;return e?"/api/v1/timelines/tag/".concat(e):"/api/v1/timelines/public"}},{key:"nextPageParams",value:function(){var e=this.state;return{local:e.config.onlyLocal,only_media:!0,max_id:e.nextId||void 0}}},{key:"loadMore",value:function(){var e=this;this.state.nextId&&(this.setState({loading:!0}),this.axios.get(this.pagePath(),{params:this.nextPageParams()}).then(function(t){var n=t.data;e.setState({items:e.state.items.concat(y(n)),loading:!1,nextId:x(n)})}))}},{key:"renderItem",value:function(e){var t=e.preview_url,n=e.meta.small.width,a=e.url,o=e.meta.original.width,c=e.status.account.display_name.trim().length>0?e.status.account.display_name:e.status.account.acct.split("@")[0];return i.a.createElement("div",{key:a,className:b()("item",{"item--larger":e.highlighted})},i.a.createElement("img",{className:"item__image",src:t,srcSet:"".concat(a," ").concat(o,"w, ").concat(t," ").concat(n,"w"),sizes:e.highlighted?"calc(0.4 * 100vw)":"calc(0.2 * 100vw)",alt:e.description}),i.a.createElement("a",{className:"item__source",href:e.status.url,target:"_blank",rel:"noopener noreferrer"},i.a.createElement("img",{src:e.status.account.avatar,alt:e.status.account.acct,width:36,height:36}),i.a.createElement("div",null,i.a.createElement("bdi",null,c),"@",e.status.account.acct)))}},{key:"render",value:function(){var e=this,t=this.state,n=t.initialized,a=t.items,o=t.config;if(!n)return i.a.createElement("div",{className:"loading"},i.a.createElement("p",null,"Loading\u2026"));return i.a.createElement("div",{className:"grid"},i.a.createElement(w.Helmet,null,i.a.createElement("title",null,o.title)),i.a.createElement(v.a,{options:{itemSelector:".item",columnWidth:".sizer",percentPosition:!0}},i.a.createElement("div",{className:"sizer"}),a.map(function(t){return e.renderItem(t)})))}}]),t}(a.Component),k=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function E(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}c.a.render(i.a.createElement(j,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat(".","/service-worker.js");k?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):E(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):E(t,e)})}}()},77:function(e,t,n){e.exports=n(229)},82:function(e,t,n){}},[[77,2,1]]]);
//# sourceMappingURL=main.8eaf2849.chunk.js.map